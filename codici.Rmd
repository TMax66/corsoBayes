---
title: "Analisi bayesiana di dati sperimentali" (appunti per un corso)
output: html_notebook
---

##Esperimento
In questo esperimento X topi sono stati randomizzati a 3 gruppi di trattamento e un gruppo di controllo. Per ogni singolo topo giornalmente, per 17 giorni,  è stato misurato il peso in grammi. L'ipotesi di lavoro è che i topi trattati avranno un -aumento di peso più rilevante rispetto a quello dei topi di controllo.

```{r include=FALSE}
source("librerie.r")
#df <- read.csv("D:/Dati/vito.tranquillo/gitProject/corsoBayes/datisp132.csv", sep=";")
df <- read.csv("datisp132.csv", sep=";")
```

```{r echo=FALSE}
head(df)
```

```{r echo=FALSE, warning=FALSE}
              
p <- ggplot(data = df, aes(x = giorno, y = peso, group = id))
p+geom_line()+stat_smooth(aes(group = 1)) + facet_grid(. ~ gruppo)
```


+ stat_summary(aes(group = 1),geom = "point", fun.y = mean, shape = 17, size = 1, col="red")




m1<-map2stan(
  alist(
    peso~dnorm(mu,sigma),
    mu<-aj[id],
    aj[id]~dnorm(0,5),
    sigma~dcauchy( 0 , 1 )
  ),
  data=df)





m2 <- map2stan(
alist(
    peso ~ dnorm( mu , sigma ),
    mu <- aj[id],
    aj[id] ~ dnorm( 0 , sigma_group ),
    sigma ~ dcauchy( 0 , 1 ),
    sigma_group ~ dcauchy( 0 , 1 )),
    data=df)

df %>% 
group_by(id) %>% 
summarize(mean(peso))
